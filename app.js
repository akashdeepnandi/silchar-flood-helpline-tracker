  // {
  //   name: "",
  //   description: "",
  //   address: "",
  //   number: "",
  // },
const helpline_data = [
  {
    name: "Dhaga",
    description: "Contact WhatsApp Only",
    address: "Das Colony | Vivekananda Road",
    numbers: [9365368410],
    isGovt: false,
  },
  {
    name: " ",
    description: "For Water and Charging",
    address: "House No - 44, 1st Link Road, Lane no. 4",
    numbers: [8472088344,9435173301,6000341591],
    isGovt: false,
  },
  {
   name: " ",
   description: "For Medicine and Water",
   address: "Tarapur, Amibcapatty, Shillongpatty, College Road, Malugram, Ashram Road",
   numbers: [7002905493,8876804938],
    isGovt: false,
  },
  {
    name: "DC Office",
    description: "For Dialysis, Time - 10 AM, 1PM",
    address: "Silchar",
    numbers: [7002508230],
    isGovt: true,
  },
  {
    name: "",
    description: "For Water",
    address: "House No. 105, Subhashini, Near Dasharupali Club, UKD Sarani",
    numbers: [7002398946],
    isGovt: false,
  },
  {
    name: "",
    description: "For Severe Patient Extract",
    address: "Silchar",
    numbers: [7002122548,9435071561],
    isGovt: false,
  },
  {
    name: "Abhishek Dey",
    description: "Any Help",
    address: "Vivekananda Road",
    numbers: [9706793152],
    isGovt: false,
  },
  {
    name: "",
    description: "For Water",
    address: "2nd Link Road, Lane No. 5, House No. 25, C/O Uttam Kumar Dey",
    numbers: [],
    isGovt: false,
  },
  {
    name: "Sulagna Dey",
    description: "For Charging",
    address: "2nd Link Road, Lane No. 5, House No. 25",
    numbers: [],
    isGovt: false,
  },
  {
    name: "",
    description: "For Water",
    address: "Ramkrishna Apartment, opposite of 2nd Link Road",
    numbers: [9957216887],
    isGovt: false,
  },
  {
    name: " ",
    description: "For Water, Charging",
    address: "Near Impluse Diagnostics, Meherpur",
    numbers: [9854247809],
    isGovt: false,
  },
  {
    name: "Rising Youth Society",
    description: " ",
    address: " ",
    numbers: [7002331303],
    isGovt: false,
  },
  {
    name: "Prasenjit",
    description: " ",
    address: "Hailakandi Road",
    numbers: [9435070389],
    isGovt: false,
  },
  {
    name: "Subir Chakraborty",
    description: " ",
    address: "Udayachal Lane, National Highway",
    numbers: [9901622334],
    isGovt: false,
  },
  {
    name: "Rakhi Dutta",
    description: " ",
    address: "Tarapur, E&D Colony",
    numbers: [9954444350],
    isGovt: false,
  },
  {
    name: "NDRF Flood Relief",
    description: " ",
    address: "Silchar",
    numbers: [9401044617],
    isGovt: true,
  },
  {
    name: "Flood Rescue and Relief",
    description: " ",
    address: "Silchar",
    numbers: [9864361904,9864353899,8822130057,6000464134,6002648243],
    isGovt: true,
  },
  {
    name: "Joydeep Malakar",
    description: " ",
    address: "Tarapur, Sonai, Hailakandi, Rangirkhari",
    numbers: [9954145808],
    isGovt: false,
  },
  {
    name: "Nabarun Purkayastha",
    description: " ",
    address: "Silchar",
    numbers: [7795068326],
    isGovt: false,
  },
  {
    name: "Sangjukta Das",
    description: " ",
    address: "Nagatilla",
    numbers: [9365355361],
    isGovt: false,
  },
  {
    name: "Lions Club, Lakhipur",
    description: " ",
    address: "Public School Road",
    numbers: [7002821245],
    isGovt: false,
  },
  {
    name: "Assam Flood Relief",
    description: " ",
    address: "Silchar",
    numbers: [9560625151],
    isGovt: true,
  },
  {
    name: "Silchar Live",
    description: " ",
    address: "Silchar",
    numbers: [9127249085,8486074166],
    isGovt: false,
  },
  {
    name: "Vivenkananda Path Mandir",
    description: " ",
    address: "Udharbond, Silchar",
    numbers: [9401140999,7002565449,9706817244],
    isGovt: false,
  },
  {
    name: "Barak Valley Welfare",
    description: " ",
    address: "Silchar",
    numbers: [8876309650],
    isGovt: false,
  },
  {
    name: "Radhamadhab Mistanna Bhandar",
    description: "For Water, Charging",
    address: " ",
    numbers: [ ],
    isGovt: false,
  },
  {
    name: "Young Minds Organisation",
    description: " ",
    address: "Silchar",
    numbers: [8472963047],
    isGovt: false,
  },
  {
    name: "Rahul Paul",
    description: " ",
    address: "Silchar",
    numbers: [9706354780,9435021638],
    isGovt: false,
  },
  {
    name: "Pratap Das",
    description: " ",
    address: "Silchar",
    numbers: [8011907694],
    isGovt: false,
  },
  {
    name: "Rescue/Evacuation",
    description: " ",
    address: "Silchar",
    numbers: [7002768843,8134978947,8134828838],
    isGovt: false,
  },
  {
    name: "Relief / Food",
    description: " ",
    address: "Silchar",
    numbers: [9101224484,9830474785],
    isGovt: false,
  },
  {
    name: " ",
    description: "For Drinking water",
    address: "Silchar",
    numbers: [8133942539,03842262979,8812970940,7002507436,8876770111],
    isGovt: false,
  },
  {
    name: " ",
    description: "For Health Related",
    address: "Silchar",
    numbers: [9394339406,7002696853,8876835691,7002905493,8876804938],
    isGovt: false,
  },
  {
    name: " ",
    description: "For Electricity",
    address: "Silchar",
    numbers: [7086044112,7635808520,7086044124 ],
    isGovt: false,
  },
  {
    name: "NDRF",
    description: "For Boat Services",
    address: "Silchar",
    numbers: [9805920811],
    isGovt: true,
  },
  {
    name: "NDRF",
    description: "Nodal Person Contact",
    address: "Silchar",
    numbers: [7002837791],
    isGovt: true,
  },
  {
    name: "NDRF",
    description: "For Relief Camp",
    address: "Silchar",
    numbers: [9435174277,9508505229,9577140631],
    isGovt: true,
  },
  {
    name: "Papu Yadav",
    description: " ",
    address: "Bilpar",
    numbers: [9365235442],
    isGovt: true,
  },
  {
    name: "NDRF (HM Mobin)",
    description: "",
    address: "Sonai Road",
    numbers: [7002593234],
    isGovt: true,
  },
  {
    name: "NDRF",
    description: "For Boat",
    address: "Sarathpally | Kanakpur | Das Colony",
    numbers: [9797222337,7002414782,9797222337,9678730623],
    isGovt: true,
  },
  {
    name: "Marwari Yuva Mancha",
    description: " ",
    address: "Silchar",
    numbers: [9435070546],
    isGovt: false,
    },
  {
    name: "Subhadeep Bhuiya",
    description: "For Water",
    address: "Shyamal's Paradise, opposite Sagarika Regency",
    numbers: [7002692278],
    isGovt: false,
  },
]

const searchInput = document.querySelector("#search");
const tbody = document.querySelector("tbody");

const createTableRow = ({ name, description, address, numbers }) => {
  const numbers_string = numbers.reduce((acc, num) => {
    acc += `<div class="number-wrapper">
      <span class="copy-icon" onclick="copyToClipboard(${num})"></span>
      <a href="tel:${num}" class="number"/>
        ${num}
      </a>
    </div>
    `
  return acc;
  }, "");

  // case 1 desc
  // case 1 desc

  const descString = description.trim() ? 
  `<div class="description">${description}</div>\n` : "";
  const nameString = name.trim() ? 
  `<div class="name">Name: ${name}</div>\n` : "";
  const addrString = address.trim() ? 
  `<div class="address">Address: ${address}</div>\n` : "";

  const row = `
    <tr>
      <td class="details">
        ${descString}
        ${nameString}
        ${addrString}
      </td>
      <td class="numbers">${numbers_string}</td>
    </tr>
  `
  return row;
}

const renderTable = (data) => {
    const html = data.reduce((acc, rowData) => {
      acc += createTableRow(rowData);
      return acc;
    }, "");
    tbody.innerHTML = html;
}



const handleSearch = (e) => {
  const search = e.target.value;
  if(!search) {
    renderTable(helpline_data);
    return;
  }
  const filteredData = helpline_data.filter(({name, description, address, numbers}) => {
    const InName = name.toLowerCase().includes(search.toLowerCase());
    const InDesc = description.toLowerCase().includes(search.toLowerCase());
    const InAddress = address.toLowerCase().includes(search.toLowerCase());
    const InNums = numbers.filter((num) => {
      const numString = `${num}`;
      return numString.includes(search)
    }).length > 0;

    return InName || InDesc || InAddress || InNums;
  });

  renderTable(filteredData);
}

function debounce(func, timeout = 300){
  let timer;
  return (...args) => {
    clearTimeout(timer);
    timer = setTimeout(() => { func.apply(this, args); }, timeout);
  };
}

const debouncedSearch = debounce(handleSearch, 500);

const copyToClipboard = async (num) => {
  try {
    await navigator.clipboard.writeText(`${num}`);
    alert("Copied to clipboard");
    return;
  } catch (err) {
    console.error(err);
    alert("Copy failed");
    return;
  }
}

searchInput.addEventListener("keyup", debouncedSearch);
searchInput.value = "";
renderTable(helpline_data);
